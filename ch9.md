### 1. 简介

前两章讲了定位的概率方法，是一个低维度感知问题，假设地图已知。  
但有些情况地图未知，或者不准确。  
因此建图可以让部署机器人更容易，也会让机器人更能适应环境变化。  
建图是真正的自动机器人的核心竞争力之一。  

建图难在：  
1. **假设空间巨大**:   
    地图定义在连续空间上，因此无限高维度；即使离散化，维度也很高。  
    因此贝叶斯滤波的方法不好使。  
2. **建图是一个“鸡-蛋”问题**:   
    有地图定位很容易，有定位建图也不难；
    但机器人的里程计精度会逐渐降低，因此建图的时候需要同时定位。  

影响建图的难度的因素有:   
尺寸，感知和执行的噪声，感知模糊度（不同地方的相似度），闭环场景。  

本章首先假设定位已知，然后介绍一系列算法，统称为*occupancy grids*。  
占据栅格地图课从有噪、不确定的测量数据中构建连续的地图。  
其思想是用一个在均匀分布的栅格中的随机变量场来表示地图。  
每一个随机变量都是二值的，对应其位置是否被占据。
占据栅格地图算法实现了这些随机变量的后验概率估计。  

这种地图的用处在于后加工（post-processing）。  
因为SLAM产生的地图不适于路径规划与导航，  
因此经常在SLAM之后使用占据栅格地图地图算法。  

### 2. 占据栅格建图算法

目标是计算地图后验$p(m|z_{1:t},x_{1:t})$。  
由于假设位姿信息已知，因此无需控制信息$u$。  

算法使用的是高分辨率的栅格，最常用的领域是二维建筑平面图。  
算法也可以泛化至三维，但计算量很大。  

把第$i$个格子记为$\bm{m}_i$；  
栅格地图由有限多个格子构成，即$m=\sum_i\bm{m}_i$。  
每个$\bm{m}_i$都可以取两个值，1为占据，0为自由。  
表达式$p(\bm{m}_i=1)$和$p(\bm{m}_i)$均指格子被占据的概率。  

地图后验的问题在于其维度。  
解决的标准做法是估计所有小格子的概率，即$p(\bm{m}_i|z_{1:t},x_{1:t}$。  
这样就不能表征相邻格子之间的相关性，即假设格子间独立：  
$p(m|z_{1:t},x_{1:t})=\Pi_ip(\bm{m}_i|z_{1:t},x_{1:t}$  

对于
